<!--主页/订单管理/历史订单-->
<!--操作栏-->
<div class="py-1 bg-info" id="option">

</div>
<!--内容-->
<div class="py-2 px-2 mt-2 bg-info" id="content">
    <!--导航栏-->
    <div class="pb-2">
        <ul class="nav nav-tabs">
            <li class="nav-item"><a href="#/Order/OrderHistory/Filter/Valid">有效订单</a></li>
            <li class="nav-item"><a href="#/Order/OrderHistory/Filter/Canceled">撤单</a></li>
            <li class="nav-item"><a href="#/Order/OrderHistory/Filter/RedBag">红包</a></li>
            <li class="nav-item"><a href="#/Order/OrderHistory/Filter/Scattered">散客</a></li>
            <li class="nav-item"><a href="#/Order/OrderHistory/Filter/All">全部订单</a></li>
        </ul>
    </div>
    <!--详细信息-->
    <div class="p-2 mb-2 bg-success form-inline">
        <a>订单总数：3202 就餐人数：29721人 总金额：￥11292410.00 人均消费：￥451.39</a>
        <!--<input class="btn btn-primary btn-sm" type="button" id="append" value="补录订单"/>-->
        <a class="btn btn-sm btn-secondary mx-1 px-2" href="#" data-toggle="modal" data-target=".order-append">补录订单</a>
    </div>
    <!--表格-->
    <div class="p-2 mb-2 bg-faded">
        <!--表格-->
        <table class="table table-hover table-bordered small">
            <thead class="bg-info">
            <tr align="center">
                <td>就餐时间</td>
                <td>区域</td>
                <td>桌号</td>
                <td>姓名</td>
                <td>手机</td>
                <td>人数</td>
                <td>接单渠道</td>
                <td>下单时间</td>
                <td>分类</td>
                <td>订单状态</td>
                <td>操作员</td>
                <td>订单详情</td>
            </tr>
            </thead>
            <tbody>
            <tr align="center">
                <td>06月08日晚餐18:00</td>
                <td>二楼</td>
                <td>(CEIEC)215 [备注]</td>
                <td>高 女士</td>
                <td>18510515888</td>
                <td>18</td>
                <td>刘光艳</td>
                <td>2017/6/8 10:57:33</td>
                <td>流失</td>
                <td>已订</td>
                <td>刘光艳</td>
                <td><a href="#" data-toggle="modal" data-target=".order-details">订单详情</a></td>
            </tr>
            </tbody>
        </table>
        <!--分页导航-->
        <nav aria-label="Page navigation">
            <ul class="pagination pagination-sm">
                <li>
                    <a href="#" aria-label="Previous">
                        <span aria-hidden="true">&laquo;</span>
                    </a>
                </li>
                <li><a href="#">1</a></li>
                <li><a href="#">2</a></li>
                <li class="active"><a href="#">3</a></li>
                <li><a href="#">4</a></li>
                <li><a href="#">5</a></li>
                <li><a href="#">6</a></li>
                <li><a href="#">7</a></li>
                <li><a href="#">8</a></li>
                <li><a href="#">9</a></li>
                <li><a href="#">10</a></li>
                <li>
                    <a href="#" aria-label="Next">
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                </li>
            </ul>
        </nav>
    </div>
</div>
<!--对话框/订单详情-->
<div class="modal order-details" id="order-details" role="dialog" aria-labelledby="order-details">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header bg-primary" style="height: 35px;">
                <a>订单详情</a>
            </div>
            <div class="modal-body">
                <div class="row bg-faded">
                    <div class="px-3 py-2">2017年6月7日 周三 晚餐</div>
                </div>
                <div class="m-2">
                    <!--Nav tabs-->
                    <nav>
                        <ul class="nav nav-tabs">
                            <li class="nav-item active"><a href="#order_pane" role="tab" data-toggle="tab">订单信息</a></li>
                            <li class="nav-item"><a href="#option_pane" role="tab" data-toggle="tab">操作信息</a></li>
                        </ul>
                    </nav>
                    <!--Tab panes-->
                    <div class="tab-content">
                        <div role="tabpanel" class="tab-pane active" id="order_pane">
                            <div class="text-info">
                                <p><strong>三楼 315</strong></p>
                                <p><strong>张 先生 100 0000 0000 6人 未分类客户</strong></p>
                                <p><strong>用餐时间：2017年6月7日 周三(晚餐) 14:57</strong></p>
                                <p><strong>创建时间：2017年6月7日14:59 操作：XXX</strong></p>
                            </div>
                            <div class="text-info bg-faded p-2">
                                <p>备注：给女朋友过生日，提前到店布置房间。</p>
                            </div>
                            <div>
                                <div class="img-thumbnail p-2 m-1">IMG1</div>
                                <div class="img-thumbnail p-2 m-1">IMG2</div>
                                <div class="img-thumbnail p-2 m-1">IMG3</div>
                                <div class="img-thumbnail p-2 m-1">IMG4</div>
                                <div class="img-thumbnail p-2 m-1">IMG5</div>
                            </div>
                            <div>
                                <div class="my-3 text-sm-center">已选0</div>
                                <div class="my-3">
                                    <input class="btn btn-secondary btn-sm px-2 mx-1" type="button" value="删除"/>
                                    <input class="btn btn-primary btn-sm px-2 mx-1" type="button" value="下载"/>
                                </div>
                            </div>
                        </div>
                        <div role="tabpanel" class="tab-pane" id="option_pane">
                            <p><a>2017/6/1 13:24:42 预订单修改 单蕾</a></p>
                            <p class="text-info">对张先生18614023307预订的2017-06-02晚餐段315桌位</p>
                            <p><a>2017/6/1 13:24:42 预订单修改 单蕾</a></p>
                            <p class="text-info">对张先生18614023307预订的2017-06-02晚餐段315桌位</p>
                            <p><a>系统ID：0cdc987e-e654-43f9-a6ed-01af184c3251</a></p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <input class="btn btn-secondary" type="button" value="关闭" id="close"/>
            </div>
        </div>
    </div>
</div>
<!--对话框/补录订单-->
<div class="modal order-append" id="order-append" role="dialog" aria-labelledby="order-append">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header bg-primary" style="height: 35px">
                <a>补录订单</a>
            </div>
            <div class="modal-body">
                <table>
                    <tbody>
                    <tr>
                        <th align="right"><span class="error">*</span>电话</th>
                        <td><input name="CustomerPhoneNumber" type="text" id="CustomerTelephone" maxlength="12"></td>
                        <th align="right"><span class="error">*</span>姓名</th>
                        <td><input type="text" name="CustomerName" id="CustomerName"></td>
                        <td colspan="2"><span class="error">*</span>
                            <label class="control-label inline"><input name="CustomerGender" type="radio" value="False"> 先生 </label>
                            <label class="control-label inline"><input name="CustomerGender" type="radio" value="True"> 女士</label>
                        </td>
                    </tr>
                    <tr>
                        <th><span class="error">*</span>人数</th>
                        <td colspan="5">
                            <input id="People" name="People" type="text" size="8" onpaste="return false">
                            <ul class="pagination pagination-sm">
                                <li><a href="#/Dialog/People/SetCount/4">4</a></li>
                                <li><a href="#/Dialog/People/SetCount/5">5</a></li>
                                <li><a href="#/Dialog/People/SetCount/6">6</a></li>
                                <li><a href="#/Dialog/People/SetCount/7">7</a></li>
                                <li><a href="#/Dialog/People/SetCount/8">8</a></li>
                                <li><a href="#/Dialog/People/SetCount/9">9</a></li>
                                <li><a href="#/Dialog/People/SetCount/10">10</a></li>
                                <li><a href="#/Dialog/People/SetCount/11">11</a></li>
                                <li><a href="#/Dialog/People/SetCount/12">12</a></li>
                            </ul>
                        </td>
                    </tr>
                    <tr>
                        <th>单位</th>
                        <td>
                            <input name="CustomerUnit" type="text" size="20" id="CustomerUnit"></td>
                        <th><span class="obli">*</span>接单渠道</th>
                        <td>
                            <select name="UserSeviceGuid" id="UserSeviceGuid">
                                <optgroup label="内部渠道"></optgroup>
                                <option>预订台</option>
                                <option>微官网</option>
                                <option>格桑拉吉</option>
                                <option>韩麦艳</option>
                                <optgroup label="外部渠道"></optgroup>
                                <option>常客</option>
                                <option>点评预订</option>
                            </select>
                        </td>
                        <th>订金</th>
                        <td>
                            <input name="Deposit" type="text" size="8" id="Deposit" onpaste="return false"></td>
                    </tr>
                    <tr>
                        <th><span class="obli">*</span>日期</th>
                        <td>
                            <div class="data">
                                <select id="Orderfor" name="Orderfor" onchange="">
                                    <option>请选择就餐日期</option>
                                    <option>2017/6/6</option>
                                    <option>2017/6/7</option>
                                    <option>2017/6/8</option>
                                    <option>2017/6/9</option>
                                    <option>2017/6/10</option>
                                    <option>2017/6/11</option>
                                    <option>2017/6/12</option>
                                    <option>2017/6/13</option>
                                </select>
                            </div>
                        </td>
                        <th><span class="obli">*</span>餐段</th>
                        <td colspan="3">
                            <div class="meal_time_set">
                                <input type="text" value="请选择餐段" data-period="">
                                <input type="hidden">
                                <input type="hidden">
                                <a href="" class="drop"></a>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <th><span class="obli">*</span>区域</th>
                        <td colspan="5">
                            <select name="area">
                                <option data-save="1" value="0">请选择区域</option>
                                <option>一楼</option>
                                <option>二楼</option>
                                <option>三楼</option>
                                <option>五楼</option>
                                <option>六楼</option>
                            </select>
                            <select name="DeskID">
                                <option data-save="1" value="0">请选择餐位</option>
                                <option data-save="1" value="0">餐位1</option>
                                <option data-save="1" value="0">餐位2</option>
                                <option data-save="1" value="0">餐位3</option>
                                <option data-save="1" value="0">餐位4</option>
                            </select>
                        </td>
                    </tr>
                    <tr data-type="template" style="display: none">
                        <th>区域</th>
                        <td colspan="5">
                            <select name="area">
                                <option data-save="1" value="0">请选择区域</option>
                                <option>一楼</option>
                                <option>二楼</option>
                                <option>三楼</option>
                                <option>五楼</option>
                                <option>六楼</option>
                                <option>六楼散台</option>
                                <option>二楼散台</option>
                                <option>外卖</option>
                                <option>测试台</option>
                            </select>
                            <select name="DeskID">
                                <option data-save="1" value="0">请选择餐位</option>
                            </select>
                            <a data-type="table_remove" href="#/Table/Remove/table_id" class="gray_2">删除</a>
                        </td>
                    </tr>
                    <tr>
                        <th></th>
                        <td colspan="5"><a class="btn btn-link btn-primary">增加餐位</a></td>
                    </tr>
                    </tbody>
                </table>
            </div>
            <div class="modal-footer">
                <input class="btn btn-primary" type="submit" value="提交" id="submit"/>
                <input class="btn btn-secondary" type="button" value="取消" id="cancel"/>
            </div>
        </div>
    </div>
</div>
<!--操作栏模板-->
<script id="OptionTemplate" type="text/plain">
    <div class="p-2 bg-success">
        <div class="form-inline p-1">
            <a>就餐日期：</a>
            <input class="form-control form-control-sm" type="date" data-link="date_from"/>
            ~
            <input class="form-control form-control-sm" type="date" data-link="date_to"/>
            <select class="form-control form-control-sm" id="area" data-link="select_area">
                <option value="-1">请选择区域</option>
                {{for area}}
                <option value="{{:value}}">{{:name}}</option>
                {{/for }}
            </select>
            <select class="form-control form-control-sm" id="seat" data-link="select_seat">
                <option value="-1">请选择餐位</option>
                {{for seat}}
                <option value="{{:value}}">{{:name}}</option>
                {{/for }}
            </select>
            <select class="form-control form-control-sm" id="channel" data-link="select_channel">
                <option value="0">全部接单渠道</option>
                {{for channel}}
                    <optgroup label="{{:name}}">{{:name}}</optgroup>
                    {{for items}}
                        <option value="{{:value}}">{{:name}}</option>
                    {{/for }}
                {{/for }}
            </select>
            <input class="form-control form-control-sm" type="text" value="18800184976" data-link="keyword" placeholder="输入姓名或手机号"/>
            <input class="btn btn-sm btn-primary mx-1 px-2" type="button" id="query" value="查询"/>
            <input class="btn btn-sm btn-secondary mx-1 px-2" type="button" id="export" value="生成报表"/>
        </div>
    </div>


</script>
<!--表格模板-->
<script>
    var TAG = Templates.Order.OrderHistory;

    // 子页面对象
    var option = {
        data_from: "2017/06/10",
        data_to: "2017/06/09",
        select_area: -1,
        select_seat: -1,
        select_channel: 0,
        keyword: "",
        area: BanquetExpert.area,
        seat: [],
        channel: BanquetExpert.channel
    };
    // 绑定模板
    $.templates("#OptionTemplate").link("#option", option);
    // TODO: 选择开始日期
    $("#data-from").change(function () {
        Log.i(TAG, "选择开始日期：" + $(this).val());
    });
    // TODO: 选择结束日期
    $("#data-to").change(function () {
        Log.i(TAG, "选择结束日期：" + $(this).val());
    });
    // TODO: 选择区域
    $("#area").change(function () {
        Log.i(TAG, "选择区域：" + $(this).val());
        var index = $("#area").val();
        if (index === -1) {
            $.observable(option).setProperty({select_seat: -1, seat: []});
        } else {
            var seat = BanquetExpert.area[index].seat;
            $.observable(option).setProperty({select_seat: -1, seat: seat});
        }
    });
    // TODO: 选择餐位
    $("#seat").change(function () {
        Log.i(TAG, "选择餐位：" + $(this).val());
    });
    // TODO: 选择渠道
    $("#channel").change(function () {
        Log.i(TAG, "选择渠道：" + $(this).val());
    });
    // TODO: 查询关键字
    $("#keyword").change(function () {
        Log.i(TAG, "查询关键字：" + $(this).val());
    });
    // TODO: 查询
    $("#query").click(function () {
        // TODO: 查询订单数据
        var json = {
            data_from: option.data_from,
            data_to: option.data_to,
            select_area: option.select_area,
            select_seat: option.select_seat,
            select_channel: option.select_channel,
            keyword: option.keyword
        };
        Log.i(TAG, "查询订单数据：" + JSON.stringify(json));
    });
    // TODO: 导出
    $("#export").click(function () {
        // TODO: 生成报表
        Log.i(TAG, "生成报表");
    });
    // 路由设置
    var routes = {
        "/Order/OrderHistory/Filter/:type": function (type) {
            // TODO: 根据订单类型过滤订单
            Log.i(TAG, "选择了：" + type);
        }
    };
    var router = window.Router(routes);
    router.init();
</script>